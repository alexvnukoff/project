{% extends 'b24online/main_page.html' %}
{% load static from staticfiles %}
{% load i18n %}
{% load CustomFilters %}
{% load inclusionTags %}

{% block title %}
  {{ item }}
{% endblock %}

{% block header %}
    {% include "b24online/login_header.html" %}
{% endblock %}

{% block styles %}
    {{ block.super }}
    <link type="text/css" rel="stylesheet" href="{% static "b24online/css/company.css" %}" />
    <style type="text/css">
      hr.hr-divider-one { 
        border: 0; 
        height: 1px; 
        background: #333; 
        background-image: linear-gradient(to right, #ccc, #333, #ccc); 
      }
      hr.hr-divider-two { 
        border: 0; 
        height: 1px; 
        background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0)); 
      }
      .deal-item {
        padding-bottom: 10px;
        margin-bottom: 10px;
      }
      #deals {
        padding: 10px;
        margin: 10px;
      }
      .data-table th,td {
        border: 1px solid #aaaaaa;
        margin: 2px;
        padding: 2px;
      }

      .bolded {
        font-weight: bold;
      }
      
    </style>    

{% endblock %}

{% block keywords %}{% endblock %}
{% block content %}
<div class="goods-details">
    <h1>{{ item }}</h1>
    <hr class="hr-divider-one">
    <p>
      <label>{% trans 'Customer' %}:</label>
      {{ item.get_customer }}
    </p>
    <p>
      <label>{% trans 'Order date' %}:</label>
      {{ item.created }}
    </p>
    <p>
      <label>{% trans 'Order status' %}:</label>
      {{ item.get_status }}
    </p>
    <p>
      <label>{% trans 'Total order cost' %}:</label>
      
      {% with item.get_total_cost as cost_list %}
        {% if cost_list %}
          {% for cost, currency in cost_list %}
              <span class="bolded">{{ currency|getSymbol }}&nbsp;{{ cost }}</span>{% if not forloop.last %},&nbsp;{% endif %}
            </tr>
            {% endfor %}
          </table>
        {% else %}
        -
        {% endif %}
      {% endwith %}
    </p>
    <hr class="hr-divider-two">

    <div id="deals">
    {% for deal in item.get_deals %}
      <div class="deal-item" style="display: block">
      <p>
        <label>{% trans 'Deal' %}:</label>
        {{ deal }}
      </p>
      <p>
        <label>{% trans 'Supplier' %}:</label>
        {{ deal.supplier_company.name }}
      </p>
      <table width="100%" cellspacing="2" cellpadding="2" border="0" class="data-table-border">
        <tr>
          <th>{% trans 'Product' %}</th>
          <th>{% trans 'Quantity' %}</th>
          <th>{% trans 'Price' %}</th>
          <th>{% trans 'Total' %}</th>
          <th>{% trans 'Currency' %}</th>
        </tr>
        {% for deal_item in deal.get_items %}
        <tr>
          <td>{{ deal_item.item.name }}</td>
          <td align="center">{{ deal_item.quantity}}</td>
          <td align="center">{{ deal_item.cost }}</td>
          <td align="center">{{ deal_item.get_total }}</td>
          <td align="center">{{ deal_item.currency|getSymbol }}</td>
        </tr>
        {% endfor %}
      </table>  
      </div>
    {% empty %}
      {% trans 'There are no deals for the order' %}
    {% endfor %}
    </div>
    
    {% if item.can_pay %}
    <p>
      <a class="bigbuy" href="{% url 'products:deal_order_payment' item.pk %}" >{% trans 'Pay Order' %}</a>
    </p>
    {% endif %}    
    
    
</div>
{% endblock %}
