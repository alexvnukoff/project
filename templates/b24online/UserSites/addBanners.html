{% extends 'b24online/forms.html' %}
{% load i18n %}
{% load staticfiles %}
{% load CustomFilters %}
{% load compress %}

{% block content %}
{% compress css %}
<link type="text/css" rel="stylesheet" href="{% static 'b24online/css/jquery.bxslider.css' %}"/>
<link type="text/css" rel="stylesheet" href="{% static 'usersites/css/tmp.css' %}"/>{% endcompress %}
{% compress js %}
<script  type="text/javascript" src="{% static 'b24online/js/jquery.bxslider.js' %}"></script>
<script  type="text/javascript" src="{% static 'b24online/js/jquery.slimscroll.min.js' %}"></script>{% endcompress %}


<style>
.error-handler {float:none;}
.b-img.banner {width:150px;height:150px;}
.b-img.banner img {width:auto;height:auto;max-width:150px;max-height:150px;display:block;margin-left:auto;margin-right:auto;}
.b-img {float:none;}
.templates-box img.t-image {width:185px;border:1px solid #919191;display:block;}
</style>

<script type="text/javascript">
    $(document).ready(function(e) {
       $(".showtype").click(function(){
            $(".external-type, #fade-profile").show();
        });

        $(".close-regform").click(function(){
            $(".external-type, #fade-profile").hide();
        });

        $('.listtype').slimScroll({
            height: '250px',
            railVisible: true,
            alwaysVisible: false
        });

        $(".selectTemplate").click(function(event) {
            var folder = $(this).data('folder');
            var id = $(this).data('id');
            var src_1 = "{% static "usersites/templates" %}" + "/" + folder + "/1.jpg";
            var src_2 = "{% static "usersites/templates" %}" + "/" + folder + "/2.jpg";
            $('.template1').attr('src',src_1);
            $('.template2').attr('src',src_2);
            $('#input-template').val(id);
            $(".external-type, #fade-profile").hide();
      });
      $('#user_site_form').submit(function() {
        $('input[name$="block"]').each(function(index, element) {
            var li = $(this).closest('li');
            if (li.find('input[name$="advertisement_ptr"]').val() == '' && li.find('input[name$="image"]').val() == '') {
                $(this).val('');
            }
        });
      });
    });
</script>

<div id="wrapper">

    <h1>{% trans "My own site" %}</h1>
    <p>{% blocktrans %}Dear colleagues, we are pleased to inform you that for the convenience of providing your interests,
            we have developed an easy website builder that will help you create your own  external website in
            just a couple of minutes.{% endblocktrans %}
        {% trans "support" %}:
        <a href="mailto:admin@tppcenter.com">admin@tppcenter.com</a>.
    </p>

<h3>{% trans "Your site" %}</h3>

    <form enctype="multipart/form-data" method="post" action="" xmlns="http://www.w3.org/1999/html" id="user_site_form">
        {% csrf_token %}
        {{ wizard.management_form }}

        <div class="form-group banners">
        <label>{% trans "Banners" %}:</label>

                {{ form.management_form }}
                {{ form.non_form_errors }}
                <ul class="custom_images">
                {% for banner_form in form %}

                    {{ banner_form.id }}
                    {% with valid_blocks|pop_val:banner_form.block.value as block %}
                        <li>
                            <div class="label">{{ block.name }}
                              {% if "RIGHT" in block.name %} ({% trans 'Dimensions' %} 205x102)
                              {% elif "LEFT" in block.name %} ({% trans 'Dimensions' %} 218x125)
                              {% elif "FOOTER" in block.name %} ({% trans 'Dimensions' %} 540x70){%  endif %}
                            </div>
                            <div class="right">
                                {% if banner_form.initial.image %}
                                    <div class="b-img banner">
                                        <img src='{{ banner_form.initial.image.original }}'>
                                    </div>
                                {% elif banner_form.image.data %}
                                    <div class="b-img banner">
                                        <img src='{{ banner_form.image.data.file.url }}'>
                                    </div>
                                {% endif %}
                                <div>{% trans 'Remove' %}{{ banner_form.DELETE }}</div>
                                {% if banner_form.errors.image %}<small class="error">{{ banner_form.errors.image.0 }}</small>{% endif %}
                                <div class="fileinputs">
                                    <input type="file" name="{{ banner_form.image.html_name }}">
                                    <input value="{{ block.pk }}" type="hidden" name="{{ banner_form.block.html_name }}">
                                    <input value="{{ banner_form.advertisement_ptr.value|default_if_none:"" }}" type="hidden" name="{{ banner_form.advertisement_ptr.html_name }}">
                                </div>
                                <div>
                                    {% if banner_form.errors.link %}<small class="error">{{ banner_form.errors.link.0 }}</small>{% endif %}
                                    {% trans 'Link URL' %}: <input value="{{ banner_form.link.value|default_if_none:"" }}" type="text" name="{{ banner_form.link.html_name }}">
                                </div>
                            </div>
                        </li>
                    {% endwith %}
                {% endfor %}
            </ul>

            <div class="form-group">
            {% if wizard.steps.prev %}
                <button name="wizard_goto_step" type="submit" value="{{ wizard.steps.first }}">{% trans "first step" %}</button>
                <button name="wizard_goto_step" type="submit" value="{{ wizard.steps.prev }}">{% trans "prev step" %}</button>
            {% endif %}
            <input type="submit" class="bigbuy" value="{% trans 'Submit' %}">
        </div>
        </div>

    </form>
</div>
{% endblock %}
